%INCLUDE:header.pvt.html%
<div id="subheader">
	<a class="back" href="../main">Home</a>
</div>

<div id="content">
	%INCLUDE:/errors.pvt.html%
	%INCLUDE:/messages.pvt.html%

	<div>
        %[IF:Studies.count%
        
        %Session.NumberOfStudies% Studies Found<br>
        <script type="text/javascript">
        	if( %Session.NumberOfPages% > 1)
        	{
        		document.write("Pages:  ");
        		
				var i=0;
	            var previous=0;
	            previous = %Session.Page%-1;
	            if( %Session.Page% == 0) document.write("<<  ");
	            else document.write("<b><a href='?%Info.getParameters(page=)%&page="+previous+"'><<  </a></b>");
            
   	         	for (i=1;i<%Session.NumberOfPages%+1;i++)
    	        {
        	    	var page = i-1;
            		if( i == %Session.Page%+1) document.write("<b><u>"+i+"</u></b>  ");
                	else document.write("<a href='?%Info.getParameters(page=)%&page="+page+"'>"+i+"</a>  ");
            	}
            
           	 	var next=0;
           	 	next = %Session.Page%+1;
           		if( next > %Session.NumberOfPages%) document.write("  >>");
            	else document.write("<b><a href='?%Info.getParameters(page=)%&page="+next+"'>  >></a></b>");
            }
        </script>
        <br>
        
        <div>
			<div class="smaller right gray">
				Sorted by:
				<a %[IF:Session.StudiesSortKey=="name"%class="CurrentSortKey"%]IF:Session.StudiesSortKey=="name"% href="?%Info.getParameters(sortKey=name)%">name</a>,
				<a %[IF:Session.StudiesSortKey=="date"%class="CurrentSortKey"%]IF:Session.StudiesSortKey=="date"% href="?%Info.getParameters(sortKey=date)%">date</a>
			</div>
			<table class="wide separated fat">
				%[FOREACH:Studies:Study%
					<tr class="li%Study_Index2%">	
						<td class="">
							<a href="study?%Info.getParameters(sortKey=)%&xid=%Study.XID%">
								<span class="bigger compressed">%X:ZWS:Study.name%</span> <span class="gray details">%X:Study.modality%, %X:Study.imageSeries.count% series%[IF:Study.patientID%, %X:Study.patientID%%]IF:Study.patientID%%[IF:Study.accessionNumber%, %X:Study.accessionNumber%%]IF:Study.accessionNumber%</span>
								<div class="gray indent compressed">
									%X:ZWS:Study.studyName%
									%[IF:Study.comment%<div class="italic indent">%X:ZWS:Study.comment%</div>%]IF:Study.comment%
								</div>
							</a>
						</td>
					
						<td class="gray top right fat">
							%[IF:Study.date%
							<div>%Study.date.DateTime.Spanned%</div>
							%]IF:Study.date%
				
							%[IF:Study.stateText%
							<div>%X:Study.stateText%</div>
							%]IF:Study.stateText%
						</td>
						
						%[IF:Info.isMacOS%
						%[IF:Info.proposeWADORetrieve%
						<td class="narrow middle">
							<a href="osirix://?methodName=DownloadURL&Display=YES&URL='%Info.WADOBaseURL%?requestType=WADO&studyUID=%U:Study.studyInstanceUID%'"><img src="images/osirix.png"/></a>
						</td>
						%]IF:Info.proposeWADORetrieve%
						%]IF:Info.isMacOS%
						
						%[IF:Info.proposeZipDownload%
						<td class="narrow middle">
							<a href="%U:Study.name% - %U:Study.studyName%.%[IF:Info.isMacOS%osirixzip%ELSE:Info.isMacOS%zip%]IF:Info.isMacOS%?xid=%Study.XID%"><img src="images/download.png"/></a>
						</td>
						%]IF:Info.proposeZipDownload%
						
						%[IF:Info.proposeWeasis%
						<td class="narrow middle">
							<a href="/weasis.jnlp?xid=%Study.XID%"><img src="images/weasis.png"/></a>
						</td>
						%]IF:Info.proposeWeasis%
					</tr>
				%]FOREACH:Studies:Study%
			</table>
		</div>
		<script type="text/javascript">
        	if( %Session.NumberOfPages% > 1)
        	{
        		document.write("Pages:  ");
        		
				var i=0;
	            var previous=0;
	            previous = %Session.Page%-1;
	            if( %Session.Page% == 0) document.write("<<  ");
	            else document.write("<b><a href='?%Info.getParameters(page=)%&page="+previous+"'><<  </a></b>");
            
   	         	for (i=1;i<%Session.NumberOfPages%+1;i++)
    	        {
        	    	var page = i-1;
            		if( i == %Session.Page%+1) document.write("<b><u>"+i+"</u></b>  ");
                	else document.write("<a href='?%Info.getParameters(page=)%&page="+page+"'>"+i+"</a>  ");
            	}
            
           	 	var next=0;
           	 	next = %Session.Page%+1;
           		if( next > %Session.NumberOfPages%) document.write("  >>");
            	else document.write("<b><a href='?%Info.getParameters(page=)%&page="+next+"'>  >></a></b>");
            }
        </script>
		%ELSE:Studies.count%
		This list is empty.
		%]IF:Studies.count%
	</div>

</div>

%INCLUDE:footer.pvt.html%