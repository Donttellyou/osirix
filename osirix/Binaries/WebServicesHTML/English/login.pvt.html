<script src="sha1-min.js" type="text/javascript"></script>
<script type="text/javascript">
function loginAction(c) {
    document.getElementById('sha1').value = hex_sha1(document.getElementById('password').value+document.getElementById('challenge').value);
    document.getElementById('password').value = '';
    document.getElementById('challenge').value = '';
    return true;
}
</script>
<input type="hidden" id="challenge" name="challenge" value="%NewChallenge%" />
<input type="hidden" id="sha1" name="sha1" value="" />
<table id="login">
    %IfAuthenticationRequired%
    <tr><td>Username:</td><td><input type="text" id="username" name="username"></td></tr>
    <tr><td>Password:</td><td><input type="password" id="password" name="password"></td></tr>
    %/IfAuthenticationRequired%
    <tr><td></td><td><input type="submit" id="login" name="login" value="Login" onclick="return loginAction(document.getElementById('challenge').value)" /></td></tr>
</table>